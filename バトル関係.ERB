
@BATTLE_POKEMON_WILD_FRONT(ポケモンCSV番号)
#DIM P_ID
#DIM P_ID2
#DIM 戦闘結果
#DIM ポケモンCSV番号
#DIM FIRST_LINE

FIRST_LINE = LINECOUNT

CALL SET_POKEMON_ENEMY_WILD(ポケモンCSV番号)
P_ID2 = RESULT

PRINTFORML
PRINTFORML 野生の%CALLNAME:P_ID2%が現れた！！
PRINTFORMW

FOR LOCAL, 0,CHARANUM
    IF TALENT:LOCAL:手持ち順番 == 1
        P_ID == LOCAL
    ENDIF
NEXT

IF P_ID == 0
    PRINTFORML たたかえるポケモンがいない！！
    PRINTFORML %CALLNAME:MASTER%は逃げ出した・・・
    DELCHARA P_ID2
    RETURN
ENDIF

PRINTFORML
PRINTFORML いけ！%CALLNAME:P_ID%！！
PRINTFORMW

CLEARLINE LINECOUNT - FIRST_LINE        
CALL BATTLE_POKEMON_WILD_MAINCOMMAND(P_ID,P_ID2)
戦闘結果 = RESULT
IF 戦闘結果 == 9999
   ;強制終了
   DELCHARA P_ID2
   RETURN
ENDIF 

@BATTLE_POKEMON_WILD_MAINCOMMAND(P_ID, P_ID2)
#DIM P_ID
#DIM P_ID2
#DIM 逃走成功率
#DIM 逃走回数
#DIM 入力結果
#DIM FIRST_LINE
#DIM ターン数
#DIM 前衛

前衛 = P_ID
ターン数 = 0
逃走回数 = 0
FIRST_LINE = LINECOUNT
$SHOW_LOOP
P_ID = 前衛
PRINTFORML
DRAWLINE
PRINTFORML
;-----------------------------------------
PRINTFORML
PRINTFORM %CALLNAME:P_ID2% 
PRINTFORM LV.{BASE:P_ID2:ポケモンLV} 

IF TALENT:P_ID2:ポケモン性別 != 3
    PRINTFORM %GET_POKEMON_SEX(P_ID2)%
ENDIF

IF CFLAG:P_ID2:状態異常 != 0
    PRINTFORML %GET_POKEMON_CONDITIONS(P_ID2)%
ELSE
ENDIF

PRINTFORML
PRINTFORML
PRINTFORML 　　HP：{BASE:P_ID2:HP}/{MAXBASE:P_ID2:HP} 
PRINTFORML

;-----------------------------------------
PRINTFORML
PRINTFORM %CALLNAME:P_ID% 
PRINTFORM LV.{BASE:P_ID:ポケモンLV} 

IF TALENT:P_ID:ポケモン性別 != 3
    PRINTFORM %GET_POKEMON_SEX(P_ID)%
ENDIF

IF CFLAG:P_ID:状態異常 != 0
    PRINTFORM %GET_POKEMON_CONDITIONS(P_ID)%
ELSE
ENDIF

PRINTFORML
PRINTFORML
PRINTFORML 　　HP：{BASE:P_ID:HP}/{MAXBASE:P_ID:HP} 
PRINTFORML
;-------------------------------------
PRINTFORML
DRAWLINE
PRINTFORML

PRINTBUTTON "[7777] たたかう", 7777
PRINTBUTTON "[8888] ポケモン", 8888
PRINTBUTTON "[9999] 逃げる", 9999

$INPUT_LOOP
INPUT

入力結果 = RESULT

IF 入力結果 == 9999
    CLEARLINE LINECOUNT - FIRST_LINE
    逃走回数 ++
    PRINTFORML ・・・
    逃走成功率 = ((MAXBASE:P_ID:素早さ * 128 / MAXBASE:P_ID2:素早さ) + (30 * 逃走回数))*100 / 256
    IF RAND(101) <= 逃走成功率
		CLEARLINE LINECOUNT - FIRST_LINE        
         PRINTFORML 逃げ切れた！！
         逃走回数 = 0
         RETURN 9999
    ELSE
		CLEARLINE LINECOUNT - FIRST_LINE        
        PRINTFORML ダメだ、追いつかれた！！
        CALL POKEMON_ENEMY_TURN(P_ID,P_ID2)
        GOTO SHOW_LOOP
    ENDIF
    PRINTFORML 
ELSEIF 入力結果 == 8888
    CLEARLINE LINECOUNT - FIRST_LINE
    CALL POKEMON_CHANGE_INBATTLE(前衛)
    IF RESULT == 9999
        GOTO SHOW_LOOP
    ELSE
        前衛 = RESULT:1
        CALL POKEMON_ENEMY_TURN(前衛,P_ID2)
        GOTO SHOW_LOOP
    ENDIF
ELSEIF 入力結果 == 7777
    CLEARLINE LINECOUNT - FIRST_LINE

ELSE
    GOTO INPUT_LOOP
ENDIF

@POKEMON_ENEMY_TURN(P_ID, P_ID2)
#DIM P_ID
#DIM P_ID2


@POKEMON_CHANGE_INBATTLE(ARG)
#DIM 手持ちデータ1
#DIM 手持ちデータ2
#DIM 手持ちデータ3
#DIM 手持ちデータ4
#DIM 手持ちデータ5
#DIM 手持ちデータ6
#DIM 前衛
#DIM FIRST_LINE

前衛 = ARG:0

CALL POKEMON_HAND_NUMBER
手持ちデータ1 = RESULT:0
手持ちデータ2 = RESULT:1
手持ちデータ3 = RESULT:2
手持ちデータ4 = RESULT:3
手持ちデータ5 = RESULT:4
手持ちデータ6 = RESULT:5

ARG:10 = 手持ちデータ1
ARG:11 = 手持ちデータ2
ARG:12 = 手持ちデータ3
ARG:13 = 手持ちデータ4
ARG:14 = 手持ちデータ5
ARG:15 = 手持ちデータ6

$MEMEBER_CHANGE_LOOP
FIRST_LINE = LINECOUNT
PRINTFORMW どのポケモンと入れ替える？

FOR LOCAL, 1, 7
    IF (ARG:(LOCAL+9)) == 0 || (ARG:(LOCAL+9)) == 前衛
        PRINTFORML 「{LOCAL}」　 -         
    ELSE
        IF CFLAG:(ARG:(LOCAL+9)):状態異常 != 8
    	    PRINTFORM  [{LOCAL}]　  - %CALLNAME:(ARG:(LOCAL+9))% %GET_POKEMON_SEX((ARG:(LOCAL+9)))% LV.{BASE:(ARG:(LOCAL+9)):ポケモンLV} HP:{BASE:(ARG:(LOCAL+9)):HP}/{MAXBASE:(ARG:(LOCAL+9)):HP} ID.{(ARG:(LOCAL+9))} %GET_POKEMON_CONDITIONS((ARG:(LOCAL+9)))%
    	    PRINTFORM %GET_POKEMON_CONDITIONS((ARG:(LOCAL+9)))% 
            PRINTBUTTON "[つよさをみる]", (LOCAL+9)
            PRINTFORML
        ELSE
            PRINTFORM 「{LOCAL}」　 - %CALLNAME:(ARG:(LOCAL+9))% %GET_POKEMON_SEX((ARG:(LOCAL+9)))% LV.{BASE:(ARG:(LOCAL+9)):ポケモンLV} ID.{(ARG:(LOCAL+9))} ひんし
            PRINTBUTTON "[つよさをみる]", (LOCAL+9)
            PRINTFORML
        ENDIF
    ENDIF
NEXT
LOCAL = 0
PRINTFORML
PRINTFORML
PRINTFORML [9999] -もどる
DO
    INPUT
    SELECTCASE RESULT
    CASE 1
        PRINTFORMW 戻れ！！%CALLNAME:前衛%！
        PRINTFORML
        PRINTFORML
        PRINTFORML 行け！！%CALLNAME:手持ちデータ1%！
        前衛 = 手持ちデータ1
        CLEARLINE LINECOUNT - FIRST_LINE
        RETURN 1,前衛
    CASE 2
        PRINTFORMW 戻れ！！%CALLNAME:前衛%！
        PRINTFORML
        PRINTFORML
        PRINTFORML 行け！！%CALLNAME:手持ちデータ2%！
        前衛 = 手持ちデータ2
        CLEARLINE LINECOUNT - FIRST_LINE
        RETURN 1,前衛
    CASE 3
        PRINTFORMW 戻れ！！%CALLNAME:前衛%！
        PRINTFORML
        PRINTFORML
        PRINTFORML 行け！！%CALLNAME:手持ちデータ3%！
        前衛 = 手持ちデータ3
        CLEARLINE LINECOUNT - FIRST_LINE
        RETURN 1,前衛
    CASE 4
        PRINTFORMW 戻れ！！%CALLNAME:前衛%！
        PRINTFORML
        PRINTFORML
        PRINTFORML 行け！！%CALLNAME:手持ちデータ4%！
        前衛 = 手持ちデータ4
        CLEARLINE LINECOUNT - FIRST_LINE
        RETURN 1,前衛
    CASE 5
        PRINTFORMW 戻れ！！%CALLNAME:前衛%！
        PRINTFORML
        PRINTFORML
        PRINTFORML 行け！！%CALLNAME:手持ちデータ5%！
        前衛 = 手持ちデータ5
        CLEARLINE LINECOUNT - FIRST_LINE
        RETURN 1,前衛
    CASE 6
        PRINTFORMW 戻れ！！%CALLNAME:前衛%！
        PRINTFORML
        PRINTFORML
        PRINTFORML 行け！！%CALLNAME:手持ちデータ6%！
        前衛 = 手持ちデータ6
        CLEARLINE LINECOUNT - FIRST_LINE
        RETURN 1,前衛
    CASE 10
        CALL POKEMON_STATUS_DETAIL(手持ちデータ1, 0, 1)
        CLEARLINE LINECOUNT - FIRST_LINE
        GOTO MEMEBER_CHANGE_LOOP
    CASE 11
        CALL POKEMON_STATUS_DETAIL(手持ちデータ2, 0, 1)
        CLEARLINE LINECOUNT - FIRST_LINE
        GOTO MEMEBER_CHANGE_LOOP
    CASE 12
        CALL POKEMON_STATUS_DETAIL(手持ちデータ3, 0, 1)
        CLEARLINE LINECOUNT - FIRST_LINE
        GOTO MEMEBER_CHANGE_LOOP
    CASE 13
        CALL POKEMON_STATUS_DETAIL(手持ちデータ4, 0, 1)
        CLEARLINE LINECOUNT - FIRST_LINE
        GOTO MEMEBER_CHANGE_LOOP
    CASE 14
        CALL POKEMON_STATUS_DETAIL(手持ちデータ5, 0, 1)
        CLEARLINE LINECOUNT - FIRST_LINE
        GOTO MEMEBER_CHANGE_LOOP
    CASE 15
        CALL POKEMON_STATUS_DETAIL(手持ちデータ6, 0, 1)
        CLEARLINE LINECOUNT - FIRST_LINE
        GOTO MEMEBER_CHANGE_LOOP

    CASE 9999
        RETURN 9999
    ENDSELECT
LOOP 1

@POKEMON_HAND_NUMBER
#DIM 手持ちデータ1
#DIM 手持ちデータ2
#DIM 手持ちデータ3
#DIM 手持ちデータ4
#DIM 手持ちデータ5
#DIM 手持ちデータ6

手持ちデータ1 = 0
手持ちデータ2 = 0
手持ちデータ3 = 0
手持ちデータ4 = 0
手持ちデータ5 = 0
手持ちデータ6 = 0

FOR LOCAL, 0, CHARANUM
    IF TALENT:LOCAL:手持ち順番 == 1
        手持ちデータ1 = LOCAL
    ELSEIF TALENT:LOCAL:手持ち順番 == 2
        手持ちデータ2 = LOCAL
    ELSEIF TALENT:LOCAL:手持ち順番 == 3
        手持ちデータ3 = LOCAL
    ELSEIF TALENT:LOCAL:手持ち順番 == 4
        手持ちデータ4 = LOCAL
    ELSEIF TALENT:LOCAL:手持ち順番 == 5
        手持ちデータ5 = LOCAL
    ELSEIF TALENT:LOCAL:手持ち順番 == 6
        手持ちデータ6 = LOCAL
    ENDIF
NEXT
LOCAL = 0

RETURN 手持ちデータ1, 手持ちデータ2, 手持ちデータ3, 手持ちデータ4, 手持ちデータ5, 手持ちデータ6

@SET_POKEMON_ENEMY_WILD(ポケモンCSV番号)
#DIM ポケモンCSV番号
#DIM P_ID2
#DIM 性別偏差

ADDCHARA ポケモンCSV番号
P_ID2 = CHARANUM - 1

IF TALENT:P_ID2:ポケモン特殊性別

ELSE
        性別偏差 = RAND(1001)
        IF 性別偏差 <= TALENT:P_ID2:性別割合
            TALENT:P_ID2:ポケモン性別 = 1
        ELSE
            TALENT:P_ID2:ポケモン性別 = 2
        ENDIF
	;TALENT:P_ID2:ポケモン性別 == RAND(1, 3)    
ENDIF

BASE:P_ID2:個体値H == RAND(0, 32)
BASE:P_ID2:個体値A == RAND(0, 32)
BASE:P_ID2:個体値B == RAND(0, 32)
BASE:P_ID2:個体値C == RAND(0, 32)
BASE:P_ID2:個体値D == RAND(0, 32)
BASE:P_ID2:個体値S == RAND(0, 32)

TALENT:P_ID2:ポケモン性格 == RAND(1, 26)

PRINTFORML %NAME:P_ID2%に{BASE:P_ID2:個体値H}を追加して、性格は{TALENT:P_ID2:ポケモン性格}にしたよ
TRYCCALLFORM POKEMON_DATA_P{ポケモンCSV番号}(P_ID2)
CALL STATUS_POKEMON_Calculator(P_ID2)
CATCH
ENDCATCH

RETURN P_ID2

@POKEMON_DATA_P1001(P_ID2 ,登場フラグ)
#DIM P_ID2
#DIM 登場フラグ

IF 登場フラグ == 1
ELSE
    BASE:P_ID2:ポケモンLV = 5
    PRINTFORML %NAME:P_ID2%のレベルを{BASE:P_ID2:ポケモンLV}にしたぞ。
ENDIF


;@SET_POKEMON_ENEMY_TRAINER(トレーナーCSV番号)

































